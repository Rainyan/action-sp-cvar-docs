name: 'SourceMod Cvar Docs'
description: 'Automatic Markdown documentation for SourceMod plugin ConVars.'
author: 'https://github.com/Rainyan'
inputs:
  code_patterns:
    description: 'RegEx pattern for code files to match.'
    default: '^.*\.(sp|inc|SP|INC)$'
  doc_patterns:
    description: 'RegEx pattern for documentation files to match.'
    default: '^.*\.(md|MD)$'
  header_patterns:
    description: 'RegEx pattern for documentation headers to match for the location of the cvar docs placeholder.'
    default: '([Cc]vars|[Cc]on[Vv]ars|[Cc]onsole [Vv]ariables)'
  dry_run:
    description: 'Whether to print the output instead of writing to file.'
    default: false
  encoding:
    description: 'Encoding to use for file read/write operations.'
    default: 'utf-8'
runs:
  using: 'composite'
  steps:
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: "3.12"

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        python -m pip install --upgrade -r requirements.txt

    - name: Update documentation files
    - shell: bash
      run: |
        # TODO: use dry-run option correctly
        python document.py "$code_patterns" "$doc_patterns" "$header_patterns"

    - name: Debug diff
      run: git diff
# Branding reference: https://haya14busa.github.io/github-action-brandings/
branding:
  icon: 'book-open'
  color: 'green'
